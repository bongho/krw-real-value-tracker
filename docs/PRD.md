# PRD: 원화 실질 가치 트래커 (KRW Real Value Tracker)

**Version:** 2.5.1
**Date:** 2025-11-16
**Author:** Product Team
**Status:** Updated (Gemini AI UX 명확성 피드백 반영)
**Changelog:**
- v2.5.1 (2025-11-16): UX 명확성 개선 - 모든 조건에 명시적 임계값 메시지 추가, 조건 현황 요약 헤더 추가
- v2.5 (2025-11-16): 방아쇠 조건(Trigger Conditions) 로직 도입, '신호'에서 '종합 진단'으로 전환
- v2.0 (2025-11-16): 우선순위 기반 다중 지표 체계 도입 (금리차, 경상수지, GDP, CPI, VIX, CNY/KRW)
- v1.0 (2025-11-16): 초기 M2 기반 단일 평가 모델

---

## 1. 프로젝트 개요

### 1.1 프로젝트명
**원화 실질 가치 트래커 (KRW Real Value Tracker)**

### 1.2 목표 (Objective)
시장 환율(USD/KRW)과 통화량(M2)을 기준으로 계산된 '원화 실질 가치'를 시계열 차트로 비교하여, 현재 원화가 고평가/저평가되었는지 직관적으로 판단할 수 있는 **모바일 최적화 웹 대시보드**를 제공한다.

### 1.3 핵심 가설 (Hypothesis)
> "시장의 달러-원 환율은 단기적으로 수급과 심리에 의해 움직이지만, **장기적으로는 양국의 통화량(M2) 비율에 수렴**할 것이다. 이 둘 사이의 **'괴리율(Gap)'**을 시각화하면 원화 보유 여부를 결정하는 데 중요한 근거가 될 수 있다."

### 1.4 Target User
- **개인 투자자**: 외환 투자, 달러 매매 타이밍 결정
- **경제 분석가**: 통화량 기반 환율 평가 모델 검증
- **경제학도**: 통화량과 환율의 관계 학습

### 1.5 Use Case
**As-is:**
"나는 원화의 실제 가치가 궁금해서, 한국은행과 FRED(세인트루이스 연준) 사이트를 뒤져 M2 데이터를 다운받고, 야후 파이낸스에서 환율 데이터를 받아 엑셀로 복잡하게 계산한다."

**To-be:**
"나는 **모바일 브라우저에서 Vercel 링크에 접속**하여, **단 하나의 차트**에서 현재 시장 환율과 M2 기준 적정 환율이 어떻게 움직이는지, 그리고 그 차이(괴리율)가 얼마나 큰지 **즉시 확인**하고 싶다."

---

## 2. 핵심 지표 정의 (Core Metrics)

이 프로젝트의 성패를 가르는 가장 중요한 부분이다. **엔지니어가 코드로 구현할 수 있도록 '실질 가치'를 계산하는 수식을 명확하게 정의**한다.

### 2.1 입력 데이터 (Input Data)

#### 기본 지표 (v1.0)

| 데이터명 | 설명 | 빈도 | 단위 | 출처 |
|---------|------|------|------|------|
| `Market_Rate` | 시장 환율 (USD/KRW) | 일별 | 원/달러 | ExchangeRate-API |
| `KR_M2` | 한국 M2 광의통화 | 월별 | 조 원 | ECOS (한국은행) |
| `US_M2` | 미국 M2 광의통화 | 월별 | 조 달러 | FRED (세인트루이스 연은) |
| `DXY` | 달러 인덱스 | 일별 | 지수 | FRED |

#### 확장 지표 (v2.0 - Gemini 피드백 반영)

**Priority 1: 자본유출입 지표**

| 데이터명 | 설명 | 빈도 | 단위 | FRED 시리즈 코드 |
|---------|------|------|------|------------------|
| `KR_Base_Rate` | 한국은행 기준금리 | 월별 | % | `INTDSRKRM193N` |
| `US_Fed_Rate` | 미국 연방기금 금리 | 일별/월별 | % | `FEDFUNDS`, `EFFR` |

**Priority 2: 펀더멘털 지표**

| 데이터명 | 설명 | 빈도 | 단위 | FRED 시리즈 코드 |
|---------|------|------|------|------------------|
| `Current_Account` | 한국 경상수지 | 분기별 | USD | `KORBCABP6USD` |
| `Trade_Balance` | 한국 무역수지 | 분기별 | - | `XTNTVA01KRQ667S` |
| `KR_GDP_Growth` | 한국 실질 GDP 성장률 | 분기별 | % | `NGDPRSAXDCKRQ` |
| `US_GDP_Growth` | 미국 실질 GDP 성장률 | 분기별 | % | `GDPC1` |

**Priority 3: 장기가치 및 리스크 지표**

| 데이터명 | 설명 | 빈도 | 단위 | FRED 시리즈 코드 |
|---------|------|------|------|------------------|
| `KR_CPI` | 한국 소비자물가지수 | 월별 | 지수 | `FPCPITOTLZGKOR` |
| `US_CPI` | 미국 소비자물가지수 | 월별 | 지수 | `CPIAUCSL` |
| `VIX` | CBOE 변동성 지수 | 일별 | 지수 | `VIXCLS` |
| `CNY_KRW` | 위안/원 환율 | 일별 | 원/위안 | ExchangeRate-API |

### 2.2 M2 선택 근거
**M1 vs M2 비교**
- **M1**: 현금 + 요구불예금 (즉시 사용 가능한 통화)
- **M2**: M1 + 저축성예금 + 단기금융상품 (광의통화)

**결정 사항: M2를 선택**

**근거:**
1. **포괄적 유동성 반영**: M2는 M1보다 더 넓은 범위의 유동성을 포함하여 실질적인 통화 공급량을 더 정확히 반영
2. **장기 추세 분석에 적합**: 단기 변동성이 M1보다 낮아 장기적인 통화 가치 평가에 더 안정적
3. **국제 비교 표준**: 대부분의 경제 분석에서 M2를 통화량 지표로 사용
4. **중앙은행 정책 반영**: 각국 중앙은행의 통화정책이 M2에 더 직접적으로 반영됨

### 2.3 계산 지표 1: M2 기준 '적정 환율' (Calculated Fair Rate)

#### 정의
특정 기준 시점(Base Date) 이후, 양국의 M2 통화량 증가 비율을 반영하여 계산한 환율.

#### 수식
```
적정 환율(t) = 기준 시점 환율 × [ (KR_M2(t) / KR_M2(base)) / (US_M2(t) / US_M2(base)) ]
```

#### 변수 설명
- `t`: 계산 시점 (예: 2025-11-16)
- `base`: 기준 시점 (예: 2010-01-01)
- `기준 시점 환율`: 2010년 1월 1일의 시장 환율 (예: 1,167원)

#### 기준 시점 (Base Date)
**2010년 1월 1일**

**선정 근거:**
1. 2008 금융위기 이후 시장이 안정화된 시점
2. 한국은행 및 FRED 모두 신뢰할 수 있는 데이터 제공 시작
3. 충분한 역사적 데이터 확보 (15년 이상)

#### 계산 예시
```
기준 시점 (2010-01-01):
- Market_Rate: 1,167원
- KR_M2: 1,500조 원
- US_M2: 8.5조 달러

계산 시점 (2025-11-16):
- KR_M2: 3,800조 원
- US_M2: 21.0조 달러

적정 환율(2025-11-16) = 1,167 × [(3,800/1,500) / (21.0/8.5)]
                       = 1,167 × [2.533 / 2.471]
                       = 1,167 × 1.025
                       = 1,196원
```

### 2.4 계산 지표 2: '가치 괴리율' (The Gap)

#### 정의
시장 환율이 M2 기준 적정 환율 대비 얼마나 벗어나 있는지 백분율로 표시.

#### 수식
```
괴리율(t) = [ (Market_Rate(t) - 적정 환율(t)) / 적정 환율(t) ] × 100
```

#### 해석
- **괴리율 > 0** (양수): 원화 **저평가** (시장 환율이 적정 환율보다 높음 → 달러가 비쌈)
- **괴리율 < 0** (음수): 원화 **고평가** (시장 환율이 적정 환율보다 낮음 → 달러가 쌈)
- **괴리율 ≈ 0**: 적정 가치

#### 계산 예시
```
현재 시장 환율: 1,455원
M2 기준 적정 환율: 1,196원

괴리율 = [(1,455 - 1,196) / 1,196] × 100
       = (259 / 1,196) × 100
       = 21.7%

→ 원화가 21.7% 저평가되어 있음 (달러가 비쌈)
```

### 2.5 보조 지표: 달러 인덱스 (DXY)

#### 목적
**환율 변동 원인 분석**: 환율 변동이 달러의 글로벌 강세 때문인지, 원화의 약세 때문인지 구별

#### 활용 방법
- DXY 상승 + 원/달러 환율 상승 → 달러 강세가 주요 원인
- DXY 하락 + 원/달러 환율 상승 → 원화 약세가 주요 원인

#### 한계점 및 보완
**DXY의 한계:**
- DXY는 유로, 엔, 파운드 등 주요 6개국 통화 대비 달러 가치를 측정
- **원화는 DXY에 포함되지 않음**
- **위안화(CNY)도 포함되지 않음** - 한국은 중국 경제와 밀접하므로 중요한 변수

**보완 방법:**
- CNY/KRW 환율을 추가 지표로 모니터링
- DXY와 원/달러 환율의 동조화율은 약 70-80% 수준
- DXY 하락 시 원화가 예상만큼 강세를 보이지 않는 경우, 위안화 영향 확인 필요

---

## 2.6 확장 지표 체계 (Extended Indicator Framework)

> **Version 2.0 업데이트 (2025-11-16):** Gemini AI의 펀더멘털 분석 피드백 반영

환율은 단일 지표가 아닌 **다층적 요인의 종합**입니다. 원화의 실질 가치를 정확히 평가하기 위해 다음과 같은 우선순위 기반 지표 체계를 도입합니다.

### 지표 우선순위 체계

| 우선순위 | 시간 범위 | 핵심 요인 | 주요 지표 |
|---------|----------|----------|----------|
| **Priority 1** | 단기 (일~주) | 자본유출입 (Capital Flow) | 한미 금리차, 금리 전망 |
| **Priority 2** | 중기 (월~분기) | 펀더멘털 (Fundamentals) | 경상수지, 상대 GDP 성장률 |
| **Priority 3** | 장기 (년) | 구매력 및 리스크 | 상대 물가(CPI), VIX, CNY/KRW |

---

## 2.7 우선순위 1: 자본유출입 지표 (Capital Flow Indicators)

### 2.7.1 한미 기준금리 차이 (Interest Rate Differential)

#### 정의
한국과 미국의 중앙은행 기준금리 격차. **단기적으로 환율에 가장 큰 영향을 미치는 지표**.

#### 이론적 근거
**이자율 평가설 (Interest Rate Parity):** 글로벌 투자 자금은 더 높은 수익을 제공하는 시장으로 이동합니다. 미국 금리가 한국보다 높으면 원화를 팔고 달러를 사서 미국 채권에 투자하려는 유인이 커집니다.

#### 수식
```
금리차(t) = KR_Base_Rate(t) - US_Fed_Rate(t)
```

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | 출처 | FRED 시리즈 코드 |
|---------|------|------|------|------------------|
| `KR_Base_Rate` | 한국은행 기준금리 | 월별 (연 8회 결정) | 한국은행 | `INTDSRKRM193N` |
| `US_Fed_Rate` | 미국 연방기금 금리 | 일별/월별 | 연준 (Fed) | `FEDFUNDS` (월), `EFFR` (일) |

#### 해석 가이드

| 금리차 | 해석 | 원화 전망 |
|-------|------|----------|
| **금리차 > +1%** | 한국 금리가 미국보다 높음 | 원화 강세 압력 (자본 유입) |
| **금리차 ≈ 0%** | 균형 상태 | 중립 |
| **금리차 < -1%** | 미국 금리가 한국보다 높음 | 원화 약세 압력 (자본 유출) |

#### 계산 예시
```
2025년 11월 기준:
- 한국 기준금리: 3.25%
- 미국 연방기금 금리: 4.75%

금리차 = 3.25% - 4.75% = -1.50%

→ 미국 금리가 1.50%p 높음
→ 달러 자산 투자 유인 증가
→ 원화 약세 압력
```

### 2.7.2 향후 금리 전망 (Future Rate Expectations)

#### 정의
시장이 예상하는 미래 금리 변화. **현재 환율은 미래 금리 기대를 이미 반영**합니다.

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | 출처 |
|---------|------|------|------|
| `FOMC_Projection` | FOMC 금리 전망치 (중앙값) | 분기별 | FRED: `FEDTARMD` |
| `CME_FedWatch` | 시장 기반 금리 인상 확률 | 실시간 | CME FedWatch Tool |

#### 활용 방법
- **매파적 전망** (금리 인상 기대) → 달러 강세 → 원화 약세
- **비둘기파적 전망** (금리 인하 기대) → 달러 약세 → 원화 강세

---

## 2.8 우선순위 2: 펀더멘털 지표 (Fundamental Indicators)

### 2.8.1 경상수지 및 무역수지 (Current Account & Trade Balance)

#### 정의
한국의 수출입 차이. **원화 가치의 가장 근본적인 수요/공급 지표**.

#### 이론적 근거
한국은 수출 중심 국가입니다:
- **흑자 (수출 > 수입):** 반도체, 자동차 수출로 달러를 벌어옴 → 달러 매도/원화 매수 → 원화 강세
- **적자 (수출 < 수입):** 원자재 수입으로 원화 매도/달러 매수 → 원화 약세

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | FRED 시리즈 코드 |
|---------|------|------|------------------|
| `Current_Account` | 경상수지 (USD) | 분기별 | `KORBCABP6USD` |
| `Trade_Balance` | 무역수지 | 분기별 | `XTNTVA01KRQ667S` |

#### 수식
```
경상수지 흑자율(t) = Current_Account(t) / GDP(t) × 100
```

#### 해석 가이드
- **경상수지 흑자 증가** → 원화 강세 압력
- **경상수지 적자 확대** → 원화 약세 압력
- **GDP 대비 5% 이상 흑자** → 구조적 원화 강세 요인

### 2.8.2 상대 경제 성장률 (Relative GDP Growth)

#### 정의
한국과 미국의 실질 GDP 성장률 차이. **투자 자본의 흐름을 결정**.

#### 이론적 근거
경제가 더 빠르게 성장하는 국가로 투자 자금이 몰립니다. 미국 경제가 한국보다 훨씬 빠르게 성장하면 미국 자산(주식, 부동산) 투자 선호도가 높아져 달러 수요 증가.

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | FRED 시리즈 코드 |
|---------|------|------|------------------|
| `KR_GDP_Growth` | 한국 실질 GDP 성장률 | 분기별 | `NGDPRSAXDCKRQ` |
| `US_GDP_Growth` | 미국 실질 GDP 성장률 | 분기별 | `GDPC1` |

#### 수식
```
성장률 격차(t) = KR_GDP_Growth(t) - US_GDP_Growth(t)
```

#### 해석 가이드
- **성장률 격차 > 0** (한국이 더 빠름) → 원화 강세 압력
- **성장률 격차 < 0** (미국이 더 빠름) → 원화 약세 압력

---

## 2.9 우선순위 3: 장기가치 및 리스크 지표 (Long-term Value & Risk Indicators)

### 2.9.1 구매력평가 - 상대 물가 상승률 (Purchasing Power Parity - Relative CPI)

#### 정의
**일물일가의 법칙**: 동일한 상품의 가격은 환율을 반영했을 때 전 세계 어디서나 비슷해야 한다는 이론.

#### 이론적 근거
만약 한국의 물가가 미국보다 지속적으로 빠르게 상승하면, 원화의 구매력이 달러보다 빠르게 하락한다는 의미이므로 장기적으로 원화 가치는 하락해야 합니다.

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | FRED 시리즈 코드 |
|---------|------|------|------------------|
| `KR_CPI` | 한국 소비자물가지수 | 월별 | `FPCPITOTLZGKOR` |
| `US_CPI` | 미국 소비자물가지수 | 월별 | `CPIAUCSL` |

#### 수식 (PPP 기반 적정 환율)
```
PPP_적정환율(t) = 기준환율 × [KR_CPI(t) / KR_CPI(base)] / [US_CPI(t) / US_CPI(base)]
```

#### 활용 예시: 빅맥 지수
이코노미스트의 빅맥 지수는 이 이론을 활용한 대표적 사례입니다.

### 2.9.2 글로벌 위험 선호도 - VIX 지수 (Risk Appetite)

#### 정의
**VIX (Volatility Index):** CBOE가 발표하는 시장 변동성 지수. **'공포 지수'**라고도 불립니다.

#### 이론적 근거
원화는 대표적인 **위험 자산 (Risk-on asset)**입니다:
- **Risk-Off (위기 상황):** 글로벌 금융 위기, 전쟁 등 발생 시 투자자들은 위험 자산(원화, 주식)을 팔고 안전 자산(달러, 엔화, 금)을 삽니다.
- **Risk-On (안정 상황):** 시장이 안정적이면 더 높은 수익을 위해 위험 자산 선호.

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | FRED 시리즈 코드 |
|---------|------|------|------------------|
| `VIX` | CBOE 변동성 지수 | 일별 | `VIXCLS` |

#### 해석 가이드

| VIX 수준 | 시장 상태 | 원화 전망 |
|---------|----------|----------|
| **VIX < 15** | 안정 (Risk-On) | 원화 강세 압력 |
| **15 ≤ VIX < 25** | 정상 범위 | 중립 |
| **VIX ≥ 25** | 공포 (Risk-Off) | 원화 약세 압력 (자본 유출) |
| **VIX ≥ 40** | 극심한 공포 | 원화 급락 위험 |

### 2.9.3 보완 지표: 위안화 환율 (CNY/KRW)

#### 정의
원/위안 환율. **한국은 중국과 경제적으로 밀접**하므로 DXY만으로는 부족한 부분을 보완.

#### 입력 데이터

| 데이터명 | 설명 | 빈도 | 출처 |
|---------|------|------|------|
| `CNY_KRW` | 위안/원 환율 | 일별 | ExchangeRate-API |

#### 활용 방법
- 위안화 약세 + 원화 약세 → 아시아 통화 전반 약세 (달러 강세)
- 위안화 강세 + 원화 약세 → 한국 고유 리스크 (펀더멘털 악화)

---

## 2.10 M2 활용 개선 방법론

### 기존 방식의 한계
**현재 PRD v1.0의 M2 활용:**
```
적정 환율(t) = 기준환율 × [(KR_M2(t)/KR_M2(base)) / (US_M2(t)/US_M2(base))]
```
- **절대량 비교**: M2의 절대값을 비교
- **한계**: 각국 M2의 기준점이 달라 비교가 왜곡될 수 있음

### 개선 방법: 상대 증가율 비교

#### 수식 (개선 버전)
```
M2_상대증가율(t) = [KR_M2_Growth_Rate(t) / US_M2_Growth_Rate(t)]

where:
  KR_M2_Growth_Rate(t) = (KR_M2(t) - KR_M2(t-1년)) / KR_M2(t-1년) × 100
  US_M2_Growth_Rate(t) = (US_M2(t) - US_M2(t-1년)) / US_M2(t-1년) × 100
```

#### 해석
- **M2_상대증가율 > 1**: 한국이 미국보다 통화를 더 많이 공급 → 원화 가치 희석 → 원화 약세
- **M2_상대증가율 < 1**: 미국이 한국보다 통화를 더 많이 공급 → 달러 가치 희석 → 원화 강세

#### 구현 방향
- **기존 M2 절대량 방식 유지** (하위 호환성)
- **M2 상대증가율 방식 추가** (고급 분석)
- 사용자가 두 방식을 비교할 수 있도록 옵션 제공

---

## 2.11 종합 평가 방법론 (Composite Evaluation)

### 다중 지표 통합 접근

환율은 **단일 공식으로 정확히 예측할 수 없습니다**. 여러 지표를 종합적으로 고려해야 합니다.

#### 제안: 가중치 기반 종합 점수

```
종합_평가_점수 = w1 × 금리차_점수
                + w2 × 경상수지_점수
                + w3 × M2_괴리율_점수
                + w4 × GDP_성장률_점수
                + w5 × CPI_괴리율_점수
                + w6 × VIX_리스크_점수
```

#### 권장 가중치 (초기값)

| 지표 | 가중치 | 시간 범위 |
|-----|--------|----------|
| 한미 금리차 | 30% | 단기 (일~주) |
| 경상수지 | 25% | 중기 (월~분기) |
| M2 괴리율 | 20% | 장기 (년) |
| GDP 성장률 격차 | 10% | 중장기 |
| CPI 괴리율 (PPP) | 10% | 장기 |
| VIX 리스크 | 5% | 단기 (변동성 반영) |

#### 구현 전략
- **Phase 1 (현재):** M2 기반 단일 평가 유지
- **Phase 2 (확장):** 금리차, VIX 등 핵심 지표 추가
- **Phase 3 (고급):** 종합 점수 계산 및 가중치 조정 기능

## 2.12 사용자 경험 및 명확성 가이드라인 (v2.5.1)

### 2.12.1 명확성 해결 원칙 (Ambiguity Resolution Principles)

Gemini AI 피드백을 통해 도출된 핵심 원칙:

1. **항상 현재값 + 임계값 표시**
   - 단순히 의미론적 해석만 제공하지 않음
   - 명시적으로 기재: `현재값 (기준: 임계값)`
   - 예: "정상 범위" ❌ → "정상 범위입니다. 현재 VIX 20.0 (기준: 25 이하)" ✅

2. **해석과 투자 적격 기준을 일치시킴**
   - 메시지는 PASS/FAIL이 "투자 적격" 여부를 의미하는지 명확히 해야 함
   - 예시:
     - PASS: "정상 범위. 투자 적격 조건을 충족합니다."
     - FAIL: "Risk-Off 국면. 투자 적격 조건을 미충족합니다."

3. **모든 조건에 일관된 메시지 구조 적용**
   - 형식: [상태] + [현재값] + [임계값] + [투자 의미]
   - 5개 조건 모두 동일한 패턴 사용

### 2.12.2 조건별 메시지 형식 표준

#### PASS 상태 (충족)
**형식**: ✅ [의미론적 설명]. 현재 = X (기준: Y 이상/이하). 투자 적격 조건을 충족합니다.

**예시 (VIX=20)**:
```
정상 범위입니다. 현재 VIX 20.0 (기준: 25 이하). 시장 변동성이 관리 가능한 수준입니다. 투자 적격 조건을 충족합니다.
```

#### FAIL 상태 (미충족)
**형식**: ❌ [의미론적 설명]. 현재 = X (기준: Y 이상/이하). 투자 적격 조건을 미충족합니다.

**예시 (VIX=30)**:
```
Risk-Off 국면입니다. 현재 VIX 30.0 (기준: 25 이하). 시장 불안정으로 자본 유출 압력이 있습니다. 투자 적격 조건을 미충족합니다.
```

#### N/A 상태 (데이터 없음)
**형식**: ➖ 데이터 없음

### 2.12.3 조건 현황 요약 표시

**타이틀 형식**: "📋 핵심 투자 조건 현황 (5개 중 X개 충족)"

**표시 요소**:
- 총 조건 수: 5
- 충족 조건 수: X개 (✅)
- 미충족 조건 수: Y개 (❌)
- N/A 조건 수: Z개 (➖)

**목적**: 사용자가 한눈에 투자 준비도를 파악할 수 있도록 함

**예시**:
```
📋 핵심 투자 조건 현황 (5개 중 3개 충족)
✅ 3개 충족  |  ❌ 2개 미충족  |  ➖ 0개 N/A
```

### 2.12.4 개선 전후 비교

#### 개선 전 (v2.5)
```
4. 변동성 (VIX 지수) ✅
메시지: "정상 범위"
현재: 20.0 (목표: 25 이하)
```
**문제점**: "정상"이면 왜 PASS인지, 투자 기준이 무엇인지 불명확

#### 개선 후 (v2.5.1)
```
4. 변동성 (VIX 지수) ✅
정상 범위입니다. 현재 VIX 20.0 (기준: 25 이하). 시장 변동성이 관리 가능한 수준입니다. 투자 적격 조건을 충족합니다.
```
**해결책**: 명확한 임계값, 상태 설명, 투자 적격 여부 모두 표시

### 2.12.5 구현 파일 매핑

| 파일 | 개선 내용 | 변경 유형 |
|------|----------|---------|
| `lib/signal-logic.ts` | 모든 5개 조건의 메시지 형식 표준화 | 로직 개선 |
| `components/InvestmentSuggestion.tsx` | 조건 현황 요약 헤더 추가 | UI 추가 |
| `components/KeyIndicators.tsx` | VIX/금리차 레이블에 투자 적격 명시 | 라벨 개선 |

---

## 3. 기능 요구사항 (Functional Requirements)

### 3.1 핵심 화면: 메인 대시보드 (Single Page)

#### 3.1.1 시계열 차트 (Primary Feature)

**차트 타입**: Interactive Line & Area Chart

**Y축 구성** (Dual Axis):
- **좌측 Y축**: 환율 (원/달러)
  - 범위: 자동 조정 (최소값 - 50, 최대값 + 50)
- **우측 Y축**: 괴리율 (%) 또는 달러 인덱스 (DXY)
  - 괴리율: -30% ~ +30%
  - DXY: 80 ~ 120

**X축**: 날짜 (일별)

**표시 데이터 라인**:

| 라인명 | 설명 | 스타일 | 색상 | Y축 |
|-------|------|--------|------|-----|
| **시장 환율** | USD/KRW 실제 시장 환율 | 굵은 실선 (3px) | #1E40AF (Blue) | 좌측 |
| **M2 적정 환율** | 통화량 기반 계산 환율 | 점선 (2px) | #059669 (Green) | 좌측 |
| **괴리율** | 시장 환율 - 적정 환율 차이 | 반투명 영역 | #EF4444 (Red/Green) | 우측 |
| **달러 인덱스 (DXY)** | 글로벌 달러 강도 | 얇은 실선 (1.5px) | #F59E0B (Amber) | 우측 |

**모바일 최적화 요구사항**:
- **터치 제스처**:
  - 좌우 스크롤: 시간 범위 이동
  - Pinch-to-Zoom: 확대/축소
  - 탭: 특정 날짜의 상세 데이터 툴팁 표시
- **반응형**: 화면 폭 360px ~ 768px에서 차트가 명확하게 표시되어야 함
- **라벨**: 모바일에서 Y축 라벨이 겹치지 않도록 자동 조정

#### 3.1.2 기간 선택 버튼 (Time Range Selector)

**위치**: 차트 상단

**버튼 옵션**:
- **1년** (1Y): 최근 1년 데이터
- **3년** (3Y): 최근 3년 데이터
- **5년** (5Y): 최근 5년 데이터
- **전체** (ALL): 2010년 1월 1일부터 현재까지

**기본값**: 3년 (3Y)

**스타일**:
- 선택된 버튼: 파란색 배경 (#1E40AF), 흰색 텍스트
- 비선택 버튼: 회색 배경 (#E5E7EB), 검은색 텍스트
- 모바일: 버튼 크기 최소 44x44px (터치 영역 확보)

#### 3.1.3 현재 상태 요약 박스 (Summary Box)

**위치**: 차트 하단

**표시 정보**:
```
┌─────────────────────────────────────────┐
│ 현재 환율 상태                           │
├─────────────────────────────────────────┤
│ 시장 환율:     1,455원                  │
│ M2 적정 환율:  1,196원                  │
│ 괴리율:        +21.7% (원화 저평가)     │
│ 달러 인덱스:   106.5                    │
├─────────────────────────────────────────┤
│ 최종 업데이트: 2025-11-15 18:00 KST    │
└─────────────────────────────────────────┘
```

**스타일**:
- 괴리율 색상:
  - 양수(+): 빨간색 (#EF4444) → 원화 저평가
  - 음수(-): 초록색 (#10B981) → 원화 고평가
  - 0 근처 (±3%): 회색 (#6B7280) → 적정 가치
- 폰트 크기: 16px ~ 18px (모바일 가독성)

#### 3.1.4 데이터 기준일 (Data Timestamp)

**위치**: 페이지 최하단

**표시 형식**:
```
Last Updated: 2025-11-15 18:00 KST
Data Sources: ECOS (KR M2), FRED (US M2), ExchangeRate-API (USD/KRW)
```

### 3.2 추가 기능 (Optional / Phase 2)

**우선순위**: 낮음 (MVP 이후 추가 고려)

1. **알림 기능**: 괴리율이 특정 임계값(예: ±20%)을 넘으면 이메일 알림
2. **과거 데이터 다운로드**: CSV 형식으로 데이터 내보내기
3. **다른 통화 쌍**: EUR/KRW, JPY/KRW 등 추가
4. **커스텀 기준 시점**: 사용자가 Base Date를 직접 설정

---

## 4. 데이터 요구사항 (Data Requirements)

### 4.1 데이터 소스 (Data Sources)

모든 데이터는 **무료 API**를 우선적으로 사용한다.

#### 4.1.1 환율 데이터 (USD/KRW)

**Option 1 (추천): ExchangeRate-API**
- **URL**: https://www.exchangerate-api.com
- **가격**: 무료 플랜 제공 (1,500 requests/month)
- **빈도**: 일 1회 업데이트
- **형식**: JSON
- **엔드포인트 예시**:
  ```
  https://v6.exchangerate-api.com/v6/YOUR_API_KEY/pair/USD/KRW
  ```

**Option 2 (백업): Alpha Vantage**
- **URL**: https://www.alphavantage.co
- **가격**: 무료 (API 키 필요, 25 requests/day 제한)
- **빈도**: 실시간 (무료는 일별)
- **형식**: JSON/CSV
- **엔드포인트 예시**:
  ```
  https://www.alphavantage.co/query?function=FX_DAILY&from_symbol=USD&to_symbol=KRW&apikey=YOUR_API_KEY
  ```

**선택 기준**: ExchangeRate-API는 월 1,500회 요청으로 일 1회 업데이트 기준 충분하며, 간단한 엔드포인트 제공.

#### 4.1.2 미국 M2 데이터

**FRED API (Federal Reserve Economic Data)**
- **URL**: https://fred.stlouisfed.org/docs/api/fred/
- **가격**: 완전 무료 (API 키 필요)
- **빈도**: 월별, 계절 조정 (Seasonally Adjusted)
- **Series ID**: `M2SL`
- **형식**: JSON/XML
- **엔드포인트 예시**:
  ```
  https://api.stlouisfed.org/fred/series/observations?series_id=M2SL&api_key=YOUR_API_KEY&file_type=json
  ```
- **API 키 발급**: https://fred.stlouisfed.org/docs/api/api_key.html

#### 4.1.3 한국 M2 데이터

**한국은행 ECOS API**
- **URL**: https://ecos.bok.or.kr/api/
- **가격**: 완전 무료 (인증키 필요)
- **빈도**: 월별
- **통계 코드**: `101Y004` (광의통화 M2, 평잔)
- **형식**: JSON/XML
- **엔드포인트 예시**:
  ```
  https://ecos.bok.or.kr/api/StatisticSearch/YOUR_API_KEY/json/kr/1/10/101Y004/M/202001/202512/
  ```
- **인증키 발급**: https://ecos.bok.or.kr/api/ (회원가입 후 자동 발급)

#### 4.1.4 달러 인덱스 (DXY)

**Option 1 (추천): FRED API**
- **Series ID**: `DTWEXBGS` (Nominal Broad U.S. Dollar Index)
- **빈도**: 일별
- **엔드포인트 예시**:
  ```
  https://api.stlouisfed.org/fred/series/observations?series_id=DTWEXBGS&api_key=YOUR_API_KEY&file_type=json
  ```

**Option 2 (백업): Alpha Vantage**
- Forex 데이터로 DXY 추정 (USD 주요 통화 쌍 가중 평균)

### 4.2 데이터 갱신 주기 (Update Frequency)

| 데이터 | 원본 업데이트 주기 | 우리 시스템 갱신 주기 | 방법 |
|--------|-------------------|---------------------|------|
| USD/KRW 환율 | 실시간 | **일 1회** (매일 오전 9시 KST) | GitHub Actions / Vercel Cron |
| 달러 인덱스 (DXY) | 일별 | **일 1회** (매일 오전 9시 KST) | GitHub Actions / Vercel Cron |
| 미국 M2 | 월별 (매월 말 발표) | **월 1회** (매월 1일 오전 9시 KST) | GitHub Actions / Vercel Cron |
| 한국 M2 | 월별 (익월 중순 발표) | **월 1회** (매월 15일 오전 9시 KST) | GitHub Actions / Vercel Cron |

### 4.3 데이터 보간 (Interpolation)

**문제 상황**:
M2 데이터는 월별로 발표되지만, 환율은 일별로 기록된다. 차트에서 M2 기준 적정 환율을 매끄럽게 표시하려면 월별 M2 데이터를 일별로 보간해야 한다.

**해결 방법: 선형 보간 (Linear Interpolation)**

#### 수식
```
M2(d) = M2(month_start) + (M2(month_end) - M2(month_start)) × (d - month_start_day) / (month_end_day - month_start_day)
```

#### 예시
```
2025년 10월 M2: 3,750조 원
2025년 11월 M2: 3,800조 원

2025년 10월 15일의 M2 추정값:
M2(2025-10-15) = 3,750 + (3,800 - 3,750) × (15 - 1) / (30 - 1)
                = 3,750 + 50 × 14 / 29
                = 3,750 + 24.1
                = 3,774.1조 원
```

**구현 위치**: 백엔드 데이터 파이프라인에서 M2 데이터를 일별로 변환하여 정적 JSON 파일로 저장.

### 4.4 데이터 파이프라인 설계

#### Architecture Diagram
```
┌─────────────────┐
│  외부 API       │
│  (ECOS, FRED,   │
│  ExchangeRate)  │
└────────┬────────┘
         │
         │ (1) 데이터 수집
         ▼
┌─────────────────┐
│ GitHub Actions  │ ← Cron Schedule (일/월 1회)
│ or Vercel Cron  │
└────────┬────────┘
         │
         │ (2) 데이터 처리 & 계산
         │     - M2 보간
         │     - 적정 환율 계산
         │     - 괴리율 계산
         ▼
┌─────────────────┐
│ Static JSON     │ ← /public/data/krw-data.json
│ File            │
└────────┬────────┘
         │
         │ (3) 프론트엔드 로드
         ▼
┌─────────────────┐
│ Next.js App     │ ← Vercel 배포
│ (React + Chart) │
└─────────────────┘
```

#### 데이터 파일 구조 (krw-data.json)
```json
{
  "metadata": {
    "lastUpdated": "2025-11-15T18:00:00Z",
    "baseDate": "2010-01-01",
    "baseRate": 1167,
    "sources": {
      "krM2": "ECOS",
      "usM2": "FRED",
      "exchangeRate": "ExchangeRate-API",
      "dxy": "FRED"
    }
  },
  "data": [
    {
      "date": "2025-11-15",
      "marketRate": 1455,
      "krM2": 3800,
      "usM2": 21.0,
      "calculatedRate": 1196,
      "gap": 21.7,
      "dxy": 106.5
    },
    {
      "date": "2025-11-14",
      "marketRate": 1450,
      "krM2": 3799,
      "usM2": 21.0,
      "calculatedRate": 1195,
      "gap": 21.3,
      "dxy": 106.2
    }
    // ... 2010-01-01부터 현재까지의 일별 데이터
  ]
}
```

#### 구현 방법

**Option 1 (추천): GitHub Actions**
```yaml
# .github/workflows/update-data.yml
name: Update KRW Data

on:
  schedule:
    - cron: '0 0 * * *'  # 매일 UTC 00:00 (KST 09:00)
    - cron: '0 0 1,15 * *'  # 매월 1일, 15일

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Fetch and Process Data
        run: node scripts/fetch-data.js
      - name: Commit and Push
        run: |
          git config user.name "github-actions[bot]"
          git add public/data/krw-data.json
          git commit -m "Update KRW data"
          git push
```

**Option 2: Vercel Serverless Function + Vercel Cron**
- Vercel Pro 플랜에서 Cron Job 지원
- API Route에서 데이터 수집 및 Vercel KV에 저장

---

## 5. 기술 스택 (Technology Stack)

### 5.1 Frontend

#### Framework: Next.js 14 (App Router)
**이유:**
- Vercel에 최적화된 프레임워크
- Server-Side Rendering (SSR) 및 Static Site Generation (SSG) 지원
- 빠른 초기 로딩 속도 (Core Web Vitals 최적화)
- 이미지 최적화 자동화

#### UI Library: React 18
- Hooks 기반 상태 관리
- 경량화된 컴포넌트 구조

#### 차트 라이브러리: Recharts
**이유:**
- React 친화적 (선언적 컴포넌트 기반)
- 모바일 터치 제스처 지원
- Dual Y-Axis 지원
- 가볍고 커스터마이징 용이

**대안**: Chart.js + react-chartjs-2 (더 많은 차트 타입 필요시)

#### 스타일링: Tailwind CSS
- 모바일 퍼스트 반응형 디자인
- 빠른 프로토타이핑
- 번들 크기 최소화 (PurgeCSS)

### 5.2 Backend

#### Data Fetching: Node.js Scripts
- `scripts/fetch-data.js`: API 호출 및 데이터 처리
- Axios 또는 node-fetch 사용

#### 스케줄링: GitHub Actions
- Cron Job으로 일/월별 데이터 업데이트
- 무료 (Public Repository 기준)

### 5.3 Data Storage

#### Option 1 (추천): Static JSON File
- **위치**: `/public/data/krw-data.json`
- **장점**:
  - CDN을 통한 빠른 로딩
  - 서버 비용 없음
  - Git으로 버전 관리 가능
- **단점**:
  - 파일 크기 제한 (10MB 이하 권장)
  - 실시간 업데이트 어려움 (일 1회 갱신으로 충분)

#### Option 2: Vercel KV (Redis)
- **용도**: 실시간 업데이트 필요 시
- **가격**: 무료 티어 (256MB 스토리지)
- **장점**: 빠른 읽기/쓰기
- **단점**: Vercel Pro 이상 플랜 추천

### 5.4 Deployment

#### Platform: Vercel
- **Free Tier**:
  - 100GB 대역폭/월
  - Serverless Functions 100GB-hours
  - 자동 HTTPS
  - Global CDN
- **배포 방법**: Git Push 시 자동 배포

### 5.5 Monitoring & Analytics

#### Performance: Vercel Analytics (무료)
- Core Web Vitals 모니터링
- LCP, FID, CLS 추적

#### Usage: Google Analytics 4 (무료)
- 사용자 행동 분석
- 페이지 뷰, 세션 시간

---

## 6. 비기능적 요구사항 (Non-Functional Requirements)

### 6.1 성능 (Performance)

#### Core Web Vitals 목표
| 지표 | 목표 | 측정 방법 |
|-----|------|----------|
| **LCP** (Largest Contentful Paint) | < 2.5초 | Vercel Analytics |
| **FID** (First Input Delay) | < 100ms | Vercel Analytics |
| **CLS** (Cumulative Layout Shift) | < 0.1 | Vercel Analytics |

#### 최적화 전략
1. **이미지 최적화**: Next.js `<Image>` 컴포넌트 사용
2. **코드 스플리팅**: 차트 라이브러리 Lazy Loading
3. **정적 데이터**: JSON 파일을 CDN에서 직접 로드
4. **폰트 최적화**: 시스템 폰트 우선 사용

### 6.2 모바일 최적화 (Mobile-First)

#### 지원 화면 크기
- **최소 너비**: 360px (Galaxy S20 기준)
- **최대 너비**: 768px (태블릿)
- **주요 테스트 기기**:
  - iPhone 14 Pro (393 × 852)
  - Samsung Galaxy S23 (360 × 780)
  - iPad Mini (768 × 1024)

#### 터치 인터페이스
- **최소 터치 영역**: 44 × 44px (Apple HIG)
- **제스처 지원**:
  - 스와이프: 차트 스크롤
  - Pinch: 확대/축소
  - 탭: 툴팁 표시

### 6.3 접근성 (Accessibility)

#### WCAG 2.1 Level AA 준수
- **색상 대비**: 최소 4.5:1 (텍스트)
- **키보드 탐색**: 모든 버튼 Tab으로 접근 가능
- **스크린 리더**: 차트 데이터를 텍스트로도 제공
- **대체 텍스트**: 모든 시각적 요소에 aria-label 추가

### 6.4 보안 (Security)

#### API 키 관리
- **환경 변수**: `.env.local`에 저장 (Git에서 제외)
- **백엔드 전용**: API 키는 서버 사이드에서만 사용 (클라이언트 노출 금지)

#### 데이터 검증
- **입력 검증**: API 응답 데이터 스키마 검증 (Zod 또는 Yup)
- **에러 처리**: 잘못된 데이터 무시 및 로그 기록

### 6.5 호환성 (Compatibility)

#### 브라우저 지원
- **모바일**:
  - Safari 14+ (iOS)
  - Chrome 90+ (Android)
- **데스크톱**:
  - Chrome 90+
  - Firefox 88+
  - Safari 14+
  - Edge 90+

#### 네트워크
- **오프라인 지원**: 없음 (온라인 전용)
- **느린 네트워크**: Loading Spinner 표시 (3G 환경 테스트)

---

## 7. 개발 우선순위 및 마일스톤 (Milestones)

### Phase 1: MVP (4주)
**목표**: 핵심 기능만 포함한 최소 실행 가능 제품

#### Week 1: 데이터 파이프라인 구축
- [ ] 한국은행 ECOS API 연동
- [ ] FRED API 연동
- [ ] ExchangeRate-API 연동
- [ ] M2 보간 로직 구현
- [ ] 적정 환율 및 괴리율 계산

#### Week 2: 프론트엔드 기본 구조
- [ ] Next.js 프로젝트 초기화
- [ ] Tailwind CSS 설정
- [ ] 기본 레이아웃 (모바일 퍼스트)
- [ ] 정적 JSON 데이터 로딩

#### Week 3: 차트 구현
- [ ] Recharts 설치 및 설정
- [ ] Dual Y-Axis 차트 구현
- [ ] 시장 환율 + 적정 환율 라인
- [ ] 괴리율 영역 차트
- [ ] 기간 선택 버튼 (1Y, 3Y, 5Y, ALL)

#### Week 4: 통합 및 배포
- [ ] 요약 박스 구현
- [ ] GitHub Actions 설정 (데이터 자동 업데이트)
- [ ] Vercel 배포
- [ ] 모바일 테스트 (실제 기기)

### Phase 2: 개선 (2주)
**목표**: 사용자 경험 향상 및 추가 기능

- [ ] DXY 달러 인덱스 추가
- [ ] 차트 인터랙션 개선 (툴팁, 줌)
- [ ] 성능 최적화 (Core Web Vitals)
- [ ] Google Analytics 연동

### Phase 3: 확장 (미정)
- [ ] 알림 기능
- [ ] CSV 데이터 다운로드
- [ ] 다른 통화 쌍 추가

---

## 8. 성공 지표 (Success Metrics)

### 8.1 기술적 지표
- **LCP < 2.5초**: 80% 이상의 페이지 로드
- **차트 렌더링 시간 < 1초**: 모바일 기준
- **데이터 갱신 성공률 > 99%**: GitHub Actions 실행 성공률

### 8.2 사용자 지표
- **월간 활성 사용자 (MAU)**: 100명 (3개월 내)
- **평균 세션 시간**: > 2분
- **재방문율**: > 30%

### 8.3 데이터 정확성
- **API 응답 오류율 < 1%**
- **계산 로직 검증**: 엑셀 기반 수동 계산과 비교하여 오차 < 0.1%

---

## 9. 리스크 및 완화 전략 (Risks & Mitigation)

### 9.1 데이터 소스 중단
**리스크**: 무료 API가 갑자기 서비스를 중단하거나 제한을 강화할 수 있음

**완화 전략**:
- 각 데이터 타입별로 백업 API 준비 (Option 1, Option 2)
- 데이터 로컬 캐싱 (최근 30일치는 Git에 저장)
- API 응답 모니터링 (실패 시 알림)

### 9.2 무료 API 요청 제한
**리스크**: ExchangeRate-API 무료 플랜은 1,500 requests/month

**완화 전략**:
- 일 1회만 호출 (월 30회 = 1,500회보다 훨씬 적음)
- GitHub Actions에서 캐싱 활용
- 필요시 Alpha Vantage로 전환

### 9.3 M2 데이터 발표 지연
**리스크**: 한국은행 M2는 익월 중순에 발표되어 최신 데이터가 1개월 이상 늦을 수 있음

**완화 전략**:
- 최근 M2 값을 이전 값으로 추정 (보수적 접근)
- 요약 박스에 "M2 데이터: 2025년 10월 기준 (최신)" 명시

### 9.4 환율 급변동
**리스크**: 급격한 환율 변동 시 차트 Y축 범위가 부적절할 수 있음

**완화 전략**:
- Y축 자동 조정 (최소값 - 10%, 최대값 + 10%)
- 이상치(Outlier) 감지 및 별도 표시

---

## 10. FAQ

### Q1: 왜 M1이 아니라 M2를 사용하나요?
**A**: M2는 저축성예금과 단기금융상품을 포함하여 경제 내 실질적인 통화 공급량을 더 정확히 반영합니다. M1은 단기 변동성이 커서 장기 추세 분석에 부적합합니다.

### Q2: 기준 시점을 2010년으로 선정한 이유는?
**A**: 2008 금융위기 이후 시장이 안정화된 시점이며, 한국은행과 FRED 모두 신뢰할 수 있는 데이터를 제공합니다. 15년 이상의 충분한 역사적 데이터를 확보할 수 있습니다.

### Q3: 괴리율이 높으면 무조건 원화를 사야 하나요?
**A**: 아닙니다. 괴리율은 참고 지표일 뿐이며, 정치적 리스크, 금리 차이, 무역 수지 등 다른 요인도 고려해야 합니다. 이 도구는 투자 결정의 보조 수단이지 절대적인 신호가 아닙니다.

### Q4: 실시간 데이터를 제공하지 않는 이유는?
**A**: M2 데이터는 월별로만 발표되므로 실시간 환율을 반영해도 적정 환율 계산에는 의미가 없습니다. 일 1회 업데이트로 충분합니다.

### Q5: 왜 Vercel을 선택했나요?
**A**: Vercel은 Next.js에 최적화되어 있으며, 무료 티어에서도 충분한 성능과 CDN을 제공합니다. 모바일 웹앱에 필요한 빠른 로딩 속도를 보장합니다.

---

## 11. 부록 (Appendix)

### 11.1 참고 자료
- **한국은행 ECOS API 문서**: https://ecos.bok.or.kr/api/
- **FRED API 문서**: https://fred.stlouisfed.org/docs/api/fred/
- **ExchangeRate-API 문서**: https://www.exchangerate-api.com/docs
- **Recharts 공식 문서**: https://recharts.org/
- **Next.js 공식 문서**: https://nextjs.org/docs

### 11.2 관련 경제 이론
- **구매력평가설 (Purchasing Power Parity, PPP)**: 장기적으로 환율은 양국의 물가 수준에 의해 결정됨
- **통화수량설 (Quantity Theory of Money)**: 통화량이 증가하면 물가가 상승하고, 환율에 영향을 미침

### 11.3 용어 정리
- **M2 (광의통화)**: M1 + 저축성예금 + MMF + 2년 미만 정기예금
- **DXY (Dollar Index)**: 주요 6개 통화 대비 미국 달러의 가치를 나타내는 지수
- **괴리율 (Gap)**: 시장 환율과 이론적 적정 환율의 차이를 백분율로 표시
- **LCP (Largest Contentful Paint)**: 페이지에서 가장 큰 콘텐츠가 렌더링되는 시간
- **CDN (Content Delivery Network)**: 전 세계에 분산된 서버를 통해 콘텐츠를 빠르게 제공하는 네트워크

---

**문서 이력**
- **v1.0** (2025-11-16): 초안 작성
